<!DOCTYPE html>
<meta charset="utf-8">
<title>Spline Editor</title>
<style>

body {
  font: 13px sans-serif;
  position: relative;
  width: 960px;
  height: 500px;
  background-color: #232328;
}

form {
  position: absolute;
  bottom: 10px;
  left: 10px;
}

rect {
  fill: none;
  pointer-events: all;
}

.grabber {
  cursor: pointer;
  fill: white;
}

.line {
  fill: none;
  stroke: #df0000;
  stroke-width: 2px;
  stroke-linecap: round;
  stroke-linejoin: round;
  stroke-miterlimit: 10px;
}

circle {
  fill: #df0000;
}

.selected {
  fill: #ff7f0e;
  stroke: #ff7f0e;
}

</style>
<div></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
<script>

var width = 960,
    height = 500;
var toggle = true;
var initialized = false;

var zeropoints = [
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, -0.3, 0], 
  [0, 0, 0, 0, -0.3, 0], 
  [0, 0, 0, 0, -0.3, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.7, 0], 
  [0, 0, 0, 0, -0.9, 0], 
  [0, 0, 0, 0, -1.1, 0], 
  [0, 0, 0, 0, -1.4, 0], 
  [0, 0, 0, 0, -1.6, 0], 
  [0, 0, 0, 0, -1.6, 0], 
  [0, 0, 0, 0, -1.3, 0], 
  [0, 0, 0, 0, -1, 0], 
  [0, 0, 0, 0, -0.7, 0], 
  [0, 0, 0, 0, -0.5, 0], 
  [0, 0, 0, 0, -0.3, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, -0.3, 0], 
  [0, 0, 0, 0, -0.5, 0], 
  [0, 0, 0, 0, -0.7, 0], 
  [0, 0, 0, 0, -0.9, 0], 
  [0, 0, 0, 0, -1.1, 0], 
  [0, 0, 0, 0, -1.2, 0], 
  [0, 0, 0, 0, -1.4, 0], 
  [0, 0, 0, 0, -1.5, 0], 
  [0, 0, 0, 0, -1.4, 0], 
  [0, 0, 0, 0, -1.1, 0], 
  [0, 0, 0, 0, -0.8, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.3, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.5, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -1.1, 0], 
  [0, 0, 0, 0, -1.5, 0], 
  [0, 0, 0, 0, -1.8, 0], 
  [0, 0, 0, 0, -2.1, 0], 
  [0, 0, 0, 0, -2.3, 0], 
  [0, 0, 0, 0, -2.5, 0], 
  [0, 0, 0, 0, -2.6, 0], 
  [0, 0, 0, 0, -2.4, 0], 
  [0, 0, 0, 0, -1.9, 0], 
  [0, 0, 0, 0, -1.4, 0], 
  [0, 0, 0, 0, -1.1, 0], 
  [0, 0, 0, 0, -0.7, 0], 
  [0, 0, 0, 0, -0.5, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.7, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, 0.4, 0], 
  [0, 0, 0, 0, 0.7, 0], 
  [0, 0, 0, 0, 0.9, 0], 
  [0, 0, 0, 0, 0.8, 0], 
  [0, 0, 0, 0, 0.6, 0], 
  [0, 0, 0, 0, 0.3, 0], 
  [0, 0, 0, 0, 3.3, 0], 
  [0, 0, 0, 0, 2.4, 0], 
  [0, 0, 0, 0, 1.8, 0], 
  [0, 0, 0, 0, 1.2, 0], 
  [0, 0, 0, 0, 0.7, 0], 
  [0, 0, 0, 0, 0.4, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, -0.5, 0], 
  [0, 0, 0, 0, -0.9, 0], 
  [0, 0, 0, 0, -1.2, 0], 
  [0, 0, 0, 0, -1.3, 0], 
  [0, 0, 0, 0, -1.3, 0], 
  [0, 0, 0, 0, -1.1, 0], 
  [0, 0, 0, 0, -0.8, 0], 
  [0, 0, 0, 0, -0.3, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.7, 0], 
  [0, 0, 0, 0, -0.8, 0], 
  [0, 0, 0, 0, -0.9, 0], 
  [0, 0, 0, 0, -0.8, 0], 
  [0, 0, 0, 0, -0.8, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.5, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.3, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0.2, 0], 
  [0, 0, 0, 0, 0.4, 0], 
  [0, 0, 0, 0, 0.6, 0], 
  [0, 0, 0, 0, 0.8, 0], 
  [0, 0, 0, 0, 1, 0], 
  [0, 0, 0, 0, 1.1, 0], 
  [0, 0, 0, 0, 1.3, 0], 
  [0, 0, 0, 0, 1.5, 0], 
  [0, 0, 0, 0, 1.7, 0], 
  [0, 0, 0, 0, 1.7, 0], 
  [0, 0, 0, 0, 1.4, 0], 
  [0, 0, 0, 0, 1.1, 0], 
  [0, 0, 0, 0, 0.9, 0], 
  [0, 0, 0, 0, 0.7, 0], 
  [0, 0, 0, 0, 0.5, 0], 
  [0, 0, 0, 0, 0.3, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, -0.8, 0], 
  [0, 0, 0, 0, -0.9, 0], 
  [0, 0, 0, 0, -1, 0], 
  [0, 0, 0, 0, -1, 0], 
  [0, 0, 0, 0, -0.9, 0], 
  [0, 0, 0, 0, -0.7, 0], 
  [0, 0, 0, 0, -0.5, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, -2.4, 0], 
  [0, 0, 0, 0, -2, 0], 
  [0, 0, 0, 0, -1.6, 0], 
  [0, 0, 0, 0, -1.2, 0], 
  [0, 0, 0, 0, -0.9, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.7, 0], 
  [0, 0, 0, 0, -0.9, 0], 
  [0, 0, 0, 0, -1.1, 0], 
  [0, 0, 0, 0, -1.2, 0], 
  [0, 0, 0, 0, -1.4, 0], 
  [0, 0, 0, 0, -1.5, 0], 
  [0, 0, 0, 0, -1.4, 0], 
  [0, 0, 0, 0, -1.1, 0], 
  [0, 0, 0, 0, -0.8, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.3, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.5, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -1.1, 0], 
  [0, 0, 0, 0, -1.5, 0], 
  [0, 0, 0, 0, -1.8, 0], 
  [0, 0, 0, 0, -2.1, 0], 
  [0, 0, 0, 0, -2.3, 0], 
  [0, 0, 0, 0, -2.5, 0], 
  [0, 0, 0, 0, -2.6, 0], 
  [0, 0, 0, 0, -2.4, 0], 
  [0, 0, 0, 0, -1.9, 0], 
  [0, 0, 0, 0, -1.4, 0], 
  [0, 0, 0, 0, -1.1, 0], 
  [0, 0, 0, 0, -0.7, 0], 
  [0, 0, 0, 0, -0.5, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.7, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, 0.4, 0], 
  [0, 0, 0, 0, 0.7, 0], 
  [0, 0, 0, 0, 0.9, 0], 
  [0, 0, 0, 0, 0.8, 0], 
  [0, 0, 0, 0, 0.6, 0], 
  [0, 0, 0, 0, 0.3, 0], 
  [0, 0, 0, 0, 3.3, 0], 
  [0, 0, 0, 0, 2.4, 0], 
  [0, 0, 0, 0, 1.8, 0], 
  [0, 0, 0, 0, 1.2, 0], 
  [0, 0, 0, 0, 0.7, 0], 
  [0, 0, 0, 0, 0.4, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0.1, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, -0.5, 0], 
  [0, 0, 0, 0, -0.9, 0], 
  [0, 0, 0, 0, -1.2, 0], 
  [0, 0, 0, 0, -1.3, 0], 
  [0, 0, 0, 0, -1.3, 0], 
  [0, 0, 0, 0, -1.1, 0], 
  [0, 0, 0, 0, -0.8, 0], 
  [0, 0, 0, 0, -0.3, 0], 
  [0, 0, 0, 0, -0.1, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.7, 0], 
  [0, 0, 0, 0, -0.8, 0], 
  [0, 0, 0, 0, -0.9, 0], 
  [0, 0, 0, 0, -0.8, 0], 
  [0, 0, 0, 0, -0.8, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.6, 0], 
  [0, 0, 0, 0, -0.5, 0], 
  [0, 0, 0, 0, -0.4, 0], 
  [0, 0, 0, 0, -0.3, 0], 
  [0, 0, 0, 0, -0.2, 0], 
  [0, 0, 0, 0, 0, 0], 
  [0, 0, 0, 0, 0.2, 0], 
  [0, 0, 0, 0, 0.4, 0], 
  [0, 0, 0, 0, 0.6, 0], 
  [0, 0, 0, 0, 0.8, 0], 
  [0, 0, 0, 0, 1, 0], 
  [0, 0, 0, 0, 1.1, 0], 
  [0, 0, 0, 0, 1.3, 0], 
  [0, 0, 0, 0, 1.5, 0], 
  [0, 0, 0, 0, 1.7, 0], 
  [0, 0, 0, 0, 1.7, 0], 
  [0, 0, 0, 0, 1.4, 0], 
  [0, 0, 0, 0, 1.2, 0], 
  [0, 0, 0, 0, 0.9, 0], 
  [0, 0, 0, 0, 0.7, 0], 
  [0, 0, 0, 0, 0.5, 0], 
  [0, 0, 0, 0, 0.3, 0], 
  [0, 0, 0, 0, 0.1, 0]
];

var newpoints = [
 [0, 0, 0, 0.1, 0, 0.2], 
 [0, 0.2, 0, 0.4, -0.1, 0.7], 
 [0, 0.3, -0.1, 0.6, -0.1, 1], 
 [0, 0, -0.1, 0.8, -0.2, 1.3], 
 [0, 0, -0.1, 0.9, -0.2, 1.4], 
 [-0.1, 0.5, -0.2, 1, -0.2, 1.5], 
 [-0.1, 0.5, -0.2, 1, -0.3, 1.4], 
 [-0.1, 0.5, -0.2, 0.9, -0.3, 1.3], 
 [0, 0, -0.2, 0.8, -0.3, 1.3], 
 [-0.1, 0.4, -0.3, 0.9, -0.4, 1.4], 
 [-0.2, 0.5, -0.3, 0.9, -0.6, 1.4], 
 [0, 0, -0.4, 0.9, -0.7, 1.4], 
 [-0.3, 0.4, -0.6, 0.9, -0.9, 1.3], 
 [-0.3, 0.4, -0.7, 0.8, -1.1, 1.1], 
 [-0.4, 0.3, -0.9, 0.7, -1.4, 0.9], 
 [-0.5, 0.3, -1, 0.5, -1.6, 0.6], 
 [-0.6, 0.2, -1.1, 0.2, -1.6, 0.1], 
 [-0.5, -0.1, -0.9, -0.3, -1.3, -0.6], 
 [-0.4, -0.3, -0.7, -0.6, -1, -1], 
 [-0.3, -0.4, -0.5, -0.8, -0.7, -1.3], 
 [0, 0, -0.4, -0.9, -0.5, -1.4], 
 [0, 0, -0.2, -0.9, -0.3, -1.2], 
 [0, 0, -0.1, -0.7, -0.2, -0.9], 
 [0, -0.2, 0, -0.3, 0, -0.3], 
 [0, 0, 0, 0, 0, -4.6], 
 [0, 0, 0, 0, 0, -4.6], 
 [0, 0, 0, 0, 0, -4.6], 
 [0, 0, 0, 0, 0, -4.6], 
 [0, 0, 0, 0, 0, -4.6], 
 [0, 0, 0, 0, 0, -4.6], 
 [0, 0, 0, 0, 0, -4.6], 
 [0, 0, 0, 0, 0, -4.6], 
 [0, 0, 0, 0, 0, 3.9], 
 [0, 0, 0, 0, 0, 3.9], 
 [0, 0, 0, 0, 0, 3.9], 
 [0, 0, 0, 0, 0, 3.9], 
 [0, 0, 0, 0, 0, 3.9], 
 [0, 0, 0, 0, 0, 3.9], 
 [0, 0, 0, 0, 0, 3.9], 
 [0, 0, 0, 0, 0, 3.9], 
 [0, 1.3, -0.1, 2.5, -0.3, 3.6], 
 [-0.1, 1.1, -0.3, 2.2, -0.5, 3.3], 
 [-0.2, 1, -0.5, 2, -0.7, 2.9], 
 [-0.3, 0.9, -0.6, 1.7, -0.9, 2.5], 
 [-0.3, 0.7, -0.7, 1.4, -1.1, 2], 
 [0, 0, -0.8, 1.1, -1.2, 1.5], 
 [-0.4, 0.4, -0.9, 0.8, -1.4, 1], 
 [0, 0, -1, 0.4, -1.5, 0.5], 
 [-0.5, 0.1, -1, 0, -1.4, -0.1], 
 [-0.4, -0.2, -0.8, -0.4, -1.1, -0.7], 
 [-0.3, -0.3, -0.6, -0.7, -0.8, -1.1], 
 [-0.2, -0.4, -0.4, -0.8, -0.6, -1.3], 
 [0, 0, -0.3, -0.9, -0.4, -1.3], 
 [-0.1, -0.4, -0.2, -0.8, -0.3, -1.2], 
 [-0.1, -0.3, -0.1, -0.6, -0.1, -0.8], 
 [0, -0.2, 0, -0.3, 0, -0.3], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0.1, 0, 0.4], 
 [0, 0.3, 0, 0.7, 0, 1.2], 
 [0, 0.5, 0, 1.1, 0, 1.8], 
 [0, 0, 0, 1.5, 0, 2.3], 
 [0, 0.8, 0, 1.7, 0, 2.7], 
 [0, 0.9, 0, 1.9, 0, 2.9], 
 [0, 0, 0, 2, 0, 3], 
 [0, 0, 0, 2, -0.1, 3], 
 [0, 1, -0.1, 1.9, -0.2, 2.8], 
 [-0.1, 0.9, -0.2, 1.8, -0.4, 2.6], 
 [-0.1, 0.8, -0.3, 1.6, -0.5, 2.4], 
 [-0.2, 0.7, -0.4, 1.5, -0.6, 2.1], 
 [-0.2, 0.7, -0.4, 1.3, -0.6, 1.9], 
 [-0.2, 0.6, -0.4, 1.1, -0.6, 1.6], 
 [-0.2, 0.5, -0.4, 1, -0.6, 1.4], 
 [-0.2, 0.4, -0.3, 0.8, -0.4, 1.1], 
 [-0.1, 0.3, -0.3, 0.7, -0.6, 1.2], 
 [0, 0, -0.6, 1, -1.1, 1.6], 
 [-0.4, 0.6, -0.9, 1.2, -1.5, 1.9], 
 [-0.5, 0.6, -1.1, 1.3, -1.8, 2], 
 [-0.6, 0.7, -1.3, 1.3, -2.1, 2], 
 [0, 0, -1.5, 1.3, -2.3, 1.9], 
 [0, 0, -1.6, 1.1, -2.5, 1.6], 
 [-0.8, 0.5, -1.7, 0.9, -2.6, 1.2], 
 [-0.9, 0.3, -1.7, 0.7, -2.4, 1], 
 [-0.7, 0.3, -1.3, 0.7, -1.9, 1], 
 [-0.6, 0.3, -1, 0.7, -1.4, 1], 
 [0, 0, -0.8, 0.6, -1.1, 0.9], 
 [-0.3, 0.3, -0.5, 0.5, -0.7, 0.8], 
 [-0.2, 0.2, -0.4, 0.4, -0.5, 0.6], 
 [-0.1, 0.2, -0.2, 0.3, -0.2, 0.4], 
 [0, 0.1, -0.1, 0.1, -0.1, 0.1], 
 [-0.4, 0.9, -0.6, 1.7, -0.7, 2.4], 
 [-0.1, 0.7, -0.1, 1.4, -0.1, 2], 
 [0.1, 0.6, 0.2, 1.1, 0.4, 1.6], 
 [0.2, 0.5, 0.5, 0.9, 0.7, 1.2], 
 [0.3, 0.3, 0.6, 0.6, 0.9, 0.9], 
 [0.3, 0.2, 0.6, 0.4, 0.8, 0.6], 
 [0.3, 0.1, 0.5, 0.3, 0.6, 0.3], 
 [0, 0, 0.3, 0.1, 0.3, 0.1], 
 [1.2, 0.2, 2.3, 0.2, 3.3, 0.1], 
 [0.9, -0.1, 1.8, -0.4, 2.4, -0.8], 
 [0.7, -0.4, 1.3, -0.9, 1.8, -1.5], 
 [0.5, -0.6, 0.9, -1.2, 1.2, -1.9], 
 [0.3, -0.7, 0.5, -1.3, 0.7, -2], 
 [0.2, -0.6, 0.3, -1.2, 0.4, -1.8], 
 [0.1, -0.5, 0.1, -1, 0.1, -1.3], 
 [0, 0, 0, -0.5, 0, -0.5], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0, 0.1], 
 [0, 0.1, 0, 0.2, 0, 0.5], 
 [0, 0.2, 0, 0.5, 0, 0.9], 
 [0, 0, 0, 0.9, 0, 1.5], 
 [0, 0.6, 0, 1.4, 0, 2.3], 
 [0, 0.9, 0, 1.9, -0.1, 3.1], 
 [0, 0, -0.1, 2.6, -0.1, 4.1], 
 [0, 1.6, -0.1, 3.3, -0.2, 5.3], 
 [-0.1, 2, -0.2, 3.7, -0.5, 5.3], 
 [-0.2, 1.6, -0.5, 2.9, -0.9, 4.1], 
 [0, 0, -0.8, 2.2, -1.2, 3.1], 
 [-0.4, 0.9, -0.9, 1.6, -1.3, 2.2], 
 [-0.4, 0.6, -0.9, 1.1, -1.3, 1.5], 
 [-0.4, 0.4, -0.8, 0.7, -1.1, 0.9], 
 [0, 0, -0.6, 0.4, -0.8, 0.4], 
 [-0.2, 0.1, -0.3, 0.1, -0.3, 0.1], 
 [0, 0, -0.1, 0, -0.1, 0.1], 
 [0, 0, -0.2, 0.1, -0.4, 0.1], 
 [-0.2, 0, -0.4, 0.1, -0.6, 0.1], 
 [-0.2, 0, -0.5, 0, -0.7, 0], 
 [-0.3, 0, -0.5, -0.1, -0.8, -0.1], 
 [-0.3, -0.1, -0.6, -0.2, -0.9, -0.4], 
 [0, 0, -0.6, -0.4, -0.8, -0.7], 
 [-0.3, -0.3, -0.5, -0.6, -0.8, -1], 
 [-0.2, -0.4, -0.4, -0.7, -0.6, -1.2], 
 [-0.2, -0.4, -0.4, -0.9, -0.6, -1.4], 
 [0, 0, -0.3, -1.1, -0.5, -1.7], 
 [-0.2, -0.6, -0.3, -1.3, -0.4, -2], 
 [-0.1, -0.7, -0.2, -1.5, -0.3, -2.3], 
 [0, 0, -0.1, -1.7, -0.2, -2.6], 
 [0, -0.9, 0, -1.9, 0, -2.9], 
 [0, -1, 0.1, -2.1, 0.2, -3.2], 
 [0.1, -1.1, 0.3, -2.2, 0.4, -3.2], 
 [0.2, -1, 0.4, -1.9, 0.6, -2.7], 
 [0.2, -0.8, 0.5, -1.6, 0.8, -2.3], 
 [0.3, -0.7, 0.6, -1.3, 1, -1.9], 
 [0, 0, 0.7, -1.1, 1.1, -1.5], 
 [0.4, -0.4, 0.9, -0.8, 1.3, -1.1], 
 [0.5, -0.3, 1, -0.5, 1.5, -0.7], 
 [0.5, -0.2, 1.1, -0.3, 1.7, -0.3], 
 [0.6, 0, 1.2, 0, 1.7, 0.1], 
 [0.5, 0.1, 1, 0.3, 1.4, 0.6], 
 [0.4, 0.2, 0.8, 0.5, 1.1, 0.9], 
 [0.3, 0.3, 0.6, 0.7, 0.9, 1], 
 [0.3, 0.4, 0.5, 0.7, 0.7, 1], 
 [0.2, 0.3, 0.3, 0.6, 0.5, 0.9], 
 [0.1, 0.3, 0.2, 0.5, 0.3, 0.7], 
 [0.1, 0.2, 0.1, 0.2, 0.1, 0.2], 
 [-0.2, -0.7, -0.5, -1.4, -0.8, -2], 
 [-0.3, -0.6, -0.6, -1, -0.9, -1.4], 
 [-0.3, -0.4, -0.7, -0.7, -1, -1], 
 [-0.3, -0.3, -0.7, -0.5, -1, -0.6], 
 [-0.3, -0.2, -0.6, -0.3, -0.9, -0.4], 
 [-0.3, -0.1, -0.5, -0.1, -0.7, -0.2], 
 [0, 0, -0.4, 0, -0.5, 0], 
 [-0.1, 0, -0.2, 0, -0.2, 0], 
 [-0.9, 0, -1.7, 0.1, -2.4, 0.4], 
 [-0.7, 0.3, -1.4, 0.7, -2, 1.2], 
 [-0.6, 0.5, -1.1, 1.2, -1.6, 1.9], 
 [-0.5, 0.7, -0.9, 1.6, -1.2, 2.5], 
 [-0.4, 0.9, -0.7, 1.9, -0.9, 3], 
 [-0.3, 1.1, -0.5, 2.2, -0.6, 3.3], 
 [0, 0, -0.3, 2.4, -0.4, 3.6], 
 [-0.1, 1.2, -0.1, 2.5, -0.1, 3.7], 
 [0, 1.5, -0.1, 2.9, -0.2, 4.3], 
 [0, 0, -0.3, 2.6, -0.4, 3.7], 
 [-0.2, 1.1, -0.4, 2.2, -0.7, 3.1], 
 [0, 0, -0.6, 1.8, -0.9, 2.6], 
 [-0.3, 0.8, -0.7, 1.4, -1.1, 2], 
 [-0.4, 0.6, -0.8, 1.1, -1.2, 1.5], 
 [0, 0, -0.9, 0.7, -1.4, 1], 
 [-0.5, 0.2, -1, 0.4, -1.5, 0.5], 
 [0, 0, -1, 0, -1.4, -0.1], 
 [0, 0, -0.8, -0.4, -1.1, -0.7], 
 [-0.3, -0.3, -0.6, -0.7, -0.8, -1.1], 
 [-0.2, -0.4, -0.4, -0.8, -0.6, -1.3], 
 [0, 0, -0.3, -0.9, -0.4, -1.3], 
 [-0.1, -0.4, -0.2, -0.8, -0.3, -1.2], 
 [-0.1, -0.3, -0.1, -0.6, -0.1, -0.8], 
 [0, -0.2, 0, -0.3, 0, -0.3], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0, 0, -3.1], 
 [0, 0, 0, 0.1, 0, 0.4], 
 [0, 0.3, 0, 0.7, 0, 1.2], 
 [0, 0.5, 0, 1.1, 0, 1.8], 
 [0, 0.7, 0, 1.5, 0, 2.3], 
 [0, 0.8, 0, 1.7, 0, 2.7], 
 [0, 0.9, 0, 1.9, 0, 2.9], 
 [0, 1, 0, 2, 0, 3], 
 [0, 1, 0, 2, -0.1, 3], 
 [0, 1, -0.1, 1.9, -0.2, 2.8], 
 [0, 0, -0.2, 1.8, -0.4, 2.6], 
 [-0.1, 0.8, -0.3, 1.6, -0.5, 2.4], 
 [-0.2, 0.7, -0.4, 1.5, -0.6, 2.1], 
 [-0.2, 0.7, -0.4, 1.3, -0.6, 1.9], 
 [-0.2, 0.6, -0.4, 1.1, -0.6, 1.6], 
 [0, 0, -0.4, 1, -0.6, 1.4], 
 [-0.2, 0.4, -0.3, 0.8, -0.4, 1.1], 
 [-0.1, 0.3, -0.3, 0.7, -0.6, 1.2], 
 [0, 0, -0.6, 1, -1.1, 1.6], 
 [-0.4, 0.6, -0.9, 1.2, -1.5, 1.9], 
 [-0.5, 0.6, -1.1, 1.3, -1.8, 2], 
 [-0.6, 0.7, -1.3, 1.3, -2.1, 2], 
 [-0.7, 0.6, -1.5, 1.3, -2.3, 1.9], 
 [-0.8, 0.6, -1.6, 1.1, -2.5, 1.6], 
 [-0.8, 0.5, -1.7, 0.9, -2.6, 1.2], 
 [-0.9, 0.3, -1.7, 0.7, -2.4, 1], 
 [-0.7, 0.3, -1.3, 0.7, -1.9, 1], 
 [-0.6, 0.3, -1, 0.7, -1.4, 1], 
 [-0.4, 0.3, -0.8, 0.6, -1.1, 0.9], 
 [0, 0, -0.5, 0.5, -0.7, 0.8], 
 [-0.2, 0.2, -0.4, 0.4, -0.5, 0.6], 
 [-0.1, 0.2, -0.2, 0.3, -0.2, 0.4], 
 [0, 0.1, -0.1, 0.1, -0.1, 0.1], 
 [-0.4, 0.9, -0.6, 1.7, -0.7, 2.4], 
 [0, 0, -0.1, 1.4, -0.1, 2], 
 [0.1, 0.6, 0.2, 1.1, 0.4, 1.6], 
 [0.2, 0.5, 0.5, 0.9, 0.7, 1.2], 
 [0.3, 0.3, 0.6, 0.6, 0.9, 0.9], 
 [0.3, 0.2, 0.6, 0.4, 0.8, 0.6], 
 [0.3, 0.1, 0.5, 0.3, 0.6, 0.3], 
 [0, 0, 0.3, 0.1, 0.3, 0.1], 
 [1.2, 0.2, 2.3, 0.2, 3.3, 0.1], 
 [0.9, -0.1, 1.8, -0.4, 2.4, -0.8], 
 [0.7, -0.4, 1.3, -0.9, 1.8, -1.5], 
 [0.5, -0.6, 0.9, -1.2, 1.2, -1.9], 
 [0.3, -0.7, 0.5, -1.3, 0.7, -2], 
 [0.2, -0.6, 0.3, -1.2, 0.4, -1.8], 
 [0.1, -0.5, 0.1, -1, 0.1, -1.3], 
 [0, 0, 0, -0.5, 0, -0.5], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0.1, -5.9], 
 [0, 0, 0, 0, 0, 0.1], 
 [0, 0.1, 0, 0.2, 0, 0.5], 
 [0, 0.2, 0, 0.5, 0, 0.9], 
 [0, 0, 0, 0.9, 0, 1.5], 
 [0, 0.6, 0, 1.4, 0, 2.3], 
 [0, 0.9, 0, 1.9, -0.1, 3.1], 
 [0, 1.2, -0.1, 2.6, -0.1, 4.1], 
 [0, 0, -0.1, 3.3, -0.2, 5.3], 
 [0, 0, -0.2, 3.7, -0.5, 5.3], 
 [-0.2, 1.6, -0.5, 2.9, -0.9, 4.1], 
 [-0.4, 1.2, -0.8, 2.2, -1.2, 3.1], 
 [-0.4, 0.9, -0.9, 1.6, -1.3, 2.2], 
 [0, 0, -0.9, 1.1, -1.3, 1.5], 
 [-0.4, 0.4, -0.8, 0.7, -1.1, 0.9], 
 [0, 0, -0.6, 0.4, -0.8, 0.4], 
 [-0.2, 0.1, -0.3, 0.1, -0.3, 0.1], 
 [0, 0, -0.1, 0, -0.1, 0.1], 
 [-0.1, 0, -0.2, 0.1, -0.4, 0.1], 
 [-0.2, 0, -0.4, 0.1, -0.6, 0.1], 
 [-0.2, 0, -0.5, 0, -0.7, 0], 
 [-0.3, 0, -0.5, -0.1, -0.8, -0.1], 
 [0, 0, -0.6, -0.2, -0.9, -0.4], 
 [-0.3, -0.2, -0.6, -0.4, -0.8, -0.7], 
 [-0.3, -0.3, -0.5, -0.6, -0.8, -1], 
 [-0.2, -0.4, -0.4, -0.7, -0.6, -1.2], 
 [0, 0, -0.4, -0.9, -0.6, -1.4], 
 [-0.2, -0.5, -0.3, -1.1, -0.5, -1.7], 
 [-0.2, -0.6, -0.3, -1.3, -0.4, -2], 
 [-0.1, -0.7, -0.2, -1.5, -0.3, -2.3], 
 [-0.1, -0.8, -0.1, -1.7, -0.2, -2.6], 
 [0, -0.9, 0, -1.9, 0, -2.9], 
 [0, -1, 0.1, -2.1, 0.2, -3.2], 
 [0, 0, 0.3, -2.2, 0.4, -3.2], 
 [0.2, -1, 0.4, -1.9, 0.6, -2.7], 
 [0.2, -0.8, 0.5, -1.6, 0.8, -2.3], 
 [0.3, -0.7, 0.6, -1.3, 1, -1.9], 
 [0, 0, 0.7, -1.1, 1.1, -1.5], 
 [0.4, -0.4, 0.9, -0.8, 1.3, -1.1], 
 [0, 0, 1, -0.5, 1.5, -0.7], 
 [0.5, -0.2, 1.1, -0.3, 1.7, -0.3], 
 [0.6, 0, 1.2, 0, 1.7, 0.1], 
 [0.5, 0.1, 1, 0.3, 1.4, 0.6], 
 [0.4, 0.3, 0.8, 0.6, 1.2, 0.9], 
 [0.3, 0.3, 0.7, 0.7, 0.9, 1.1], 
 [0.3, 0.4, 0.5, 0.8, 0.7, 1.1], 
 [0.2, 0.4, 0.4, 0.7, 0.5, 1], 
 [0.1, 0.3, 0.2, 0.5, 0.3, 0.7], 
 [0.1, 0.2, 0.1, 0.3, 0.1, 0.3]
];

var size = {
  'x': 280,
  'y': 170
}

var svg = d3.select("body").append("svg")
  .attr("width", width)
  .attr("height", height)
  .attr("tabindex", 1);

var path = svg.append("path")
  .attr("class", "line");
    
var dot1 = svg.append("circle")
  .attr("r", 2)
  .attr("cx", 133)
  .attr("cy", -8)
  .attr("class", "circle");

var dot2 = svg.append("circle")
  .attr("r", 2)
  .attr("cx", 174)
  .attr("cy", -8)
  .attr("class", "circle");

var grab = svg.append("circle")
  .attr("r", 10)
  .attr("cx", 200)
  .attr("cy", 100)
  .attr('opacity', 0)
  .attr("class", "grabber");

var m1, m2, m3, line, stretch = [0,0], flex = [0,0], pathArray = [], isDown = false, lineDown = false, isDragging = false;

function lineparser(linepoints, cursorpos, cursorpos_2) {
  var expoints = false;
  var startpos = cursorpos_2 ? cursorpos_2 : cursorpos;
  var deltax = cursorpos[0] - startpos[0];
  var deltay = cursorpos[1] - startpos[1];
  var pad = [cursorpos[0], cursorpos[1]];
  var returnstring = "M" + parseFloat(cursorpos[0]) + ',' + parseFloat(cursorpos[1]) + ' ';
  for (var i = 0; i < linepoints.length; i++) {
    var points = linepoints[i].slice();
    var dx = deltax / 8;
    var dy = deltay / 8;
    if (expoints) {
      pad = [expoints[4], expoints[5]];
    }
    if (isDown) {
      flex[0] = flex[2] = flex[4] = dx / (i + 1);
      flex[1] = flex[3] = flex[5] = dy / (i + 1);
    } else {
      flex[0] = flex[1] = flex[2] = flex[3] = flex[4] = flex[5] = 0;
    }
    points[0] += pad[0] - flex[0];
    points[1] += pad[1] - flex[1];
    points[2] += pad[0] - flex[2];
    points[3] += pad[1] - flex[3];
    points[4] += pad[0] - flex[4];
    points[5] += pad[1] - flex[5];
    var coords = points.join(',');
    returnstring += 'C' + coords + ' ';
    expoints = points;
  }
  return returnstring;
}

if (!initialized) {
  m1 = [200, 100];
  m3 = m1;
  var zp = lineparser(zeropoints, [200, 120], false);
  var ep = lineparser(newpoints, m1, false);
  path.transition()
    .duration(100)
    .ease("linear")
    .attr("d", zp)
    .transition()
    .duration(300)
    .ease("sin-out")
    .attr("d", ep);

  dot1.transition()
    .delay(700)
    .duration(200)
    .ease("elastic-in")
    .attr("cx", 133)
    .attr("cy", 95);
  dot2.transition()
    .delay(700)
    .duration(250)
    .ease("elastic-in")
    .attr("cx", 174)
    .attr("cy", 80);
  grab.transition()
    .delay(700)
    .duration(500)
    .ease("sine-in")
    .attr("opacity", 0.2);
  initialized = true;
}

function mousedown() {
  isDown = (m1[0] > m3[0] - 20 && m1[0] < m3[0] + 20 && m1[1] > m3[1] - 20 && m1[1] < m3[1] + 20);
}
function mousemove() {
  if (isDown){
    m2 = d3.mouse(this);
    var ep = lineparser(newpoints, m2, m1);
    path.attr('d', ep);
    grab.attr("cx", m2[0]);
    grab.attr("cy", m2[1]);
  }
}
function mouseup() {
  if (isDown) {
    isDown = false;
    var ep = lineparser(newpoints, m1, false);
    path.transition()
      .duration(900)
      .ease("elastic-in")
      .attr("d", ep);
    grab.transition()
      .duration(900)
      .ease("elastic-in")
      .attr("cx", m1[0])
      .attr("cy", m1[1]);
  }
}
svg.on('mousedown', mousedown);
svg.on('mousemove', mousemove);
svg.on('mouseup', mouseup);

</script>
